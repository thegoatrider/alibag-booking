{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/lib/availability.ts"],"sourcesContent":["import { supabase } from \"./supabase\";\r\n\r\nexport async function getAvailableRooms(\r\n  bucketId: string,\r\n  checkIn: string,\r\n  checkOut: string\r\n) {\r\n  // 1. Get all rooms in bucket\r\n  const { data: rooms } = await supabase\r\n    .from(\"rooms\")\r\n    .select(\"id, room_name, hotel_id, hotels(name)\")\r\n    .eq(\"hotels.bucket_id\", bucketId);\r\n\r\n  if (!rooms || rooms.length === 0) return [];\r\n\r\n  const roomIds = rooms.map((r) => r.id);\r\n\r\n  // 2. Get overlapping bookings\r\n  const { data: bookings } = await supabase\r\n    .from(\"bookings\")\r\n    .select(\"room_id\")\r\n    .lt(\"check_in\", checkOut)\r\n    .gt(\"check_out\", checkIn);\r\n\r\n  const bookedRoomIds = bookings?.map((b) => b.room_id) || [];\r\n\r\n  // 3. Get blocked dates\r\n  const { data: blocked } = await supabase\r\n    .from(\"blocked_dates\")\r\n    .select(\"room_id\")\r\n    .gte(\"date\", checkIn)\r\n    .lt(\"date\", checkOut);\r\n\r\n  const blockedRoomIds = blocked?.map((b) => b.room_id) || [];\r\n\r\n  // 4. Filter rooms\r\n  return rooms.filter(\r\n    (r) =>\r\n      !bookedRoomIds.includes(r.id) &&\r\n      !blockedRoomIds.includes(r.id)\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,kBACpB,QAAgB,EAChB,OAAe,EACf,QAAgB;IAEhB,6BAA6B;IAC7B,MAAM,EAAE,MAAM,KAAK,EAAE,GAAG,MAAM,2HAAQ,CACnC,IAAI,CAAC,SACL,MAAM,CAAC,yCACP,EAAE,CAAC,oBAAoB;IAE1B,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO,EAAE;IAE3C,MAAM,UAAU,MAAM,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;IAErC,8BAA8B;IAC9B,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,2HAAQ,CACtC,IAAI,CAAC,YACL,MAAM,CAAC,WACP,EAAE,CAAC,YAAY,UACf,EAAE,CAAC,aAAa;IAEnB,MAAM,gBAAgB,UAAU,IAAI,CAAC,IAAM,EAAE,OAAO,KAAK,EAAE;IAE3D,uBAAuB;IACvB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,2HAAQ,CACrC,IAAI,CAAC,iBACL,MAAM,CAAC,WACP,GAAG,CAAC,QAAQ,SACZ,EAAE,CAAC,QAAQ;IAEd,MAAM,iBAAiB,SAAS,IAAI,CAAC,IAAM,EAAE,OAAO,KAAK,EAAE;IAE3D,kBAAkB;IAClB,OAAO,MAAM,MAAM,CACjB,CAAC,IACC,CAAC,cAAc,QAAQ,CAAC,EAAE,EAAE,KAC5B,CAAC,eAAe,QAAQ,CAAC,EAAE,EAAE;AAEnC"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/app/bucket/%5BbucketId%5D/rooms/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useSearchParams } from \"next/navigation\";\r\nimport { getAvailableRooms } from \"@/lib/availability\";\r\n\r\nexport default function RoomsPage() {\r\n  const { bucketId } = useParams();\r\n  const searchParams = useSearchParams();\r\n  const checkIn = searchParams.get(\"in\")!;\r\n  const checkOut = searchParams.get(\"out\")!;\r\n\r\n  const [rooms, setRooms] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      const available = await getAvailableRooms(\r\n        bucketId as string,\r\n        checkIn,\r\n        checkOut\r\n      );\r\n      setRooms(available);\r\n      setLoading(false);\r\n    };\r\n    load();\r\n  }, [bucketId, checkIn, checkOut]);\r\n\r\n  if (loading) return <p className=\"p-10\">Checking availability...</p>;\r\n\r\n  return (\r\n    <main className=\"p-10\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">\r\n        Available Rooms\r\n      </h1>\r\n\r\n      {rooms.length === 0 && (\r\n        <p className=\"text-gray-500\">\r\n          No rooms available for selected dates.\r\n        </p>\r\n      )}\r\n\r\n      <div className=\"space-y-4\">\r\n        {rooms.map((r) => (\r\n          <div\r\n            key={r.id}\r\n            className=\"border rounded-xl p-6 flex justify-between\"\r\n          >\r\n            <div>\r\n              <h2 className=\"font-semibold\">{r.hotels.name}</h2>\r\n              <p className=\"text-gray-500\">{r.room_name}</p>\r\n            </div>\r\n\r\n            <button className=\"bg-black text-white px-4 py-2 rounded\">\r\n              Select\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS;IACtB,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,+IAAS;IAC9B,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,UAAU,aAAa,GAAG,CAAC;IACjC,MAAM,WAAW,aAAa,GAAG,CAAC;IAElC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAQ,EAAE;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,MAAM,OAAO;YACX,MAAM,YAAY,MAAM,IAAA,wIAAiB,EACvC,UACA,SACA;YAEF,SAAS;YACT,WAAW;QACb;QACA;IACF,GAAG;QAAC;QAAU;QAAS;KAAS;IAEhC,IAAI,SAAS,qBAAO,8OAAC;QAAE,WAAU;kBAAO;;;;;;IAExC,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAA0B;;;;;;YAIvC,MAAM,MAAM,KAAK,mBAChB,8OAAC;gBAAE,WAAU;0BAAgB;;;;;;0BAK/B,8OAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAC,kBACV,8OAAC;wBAEC,WAAU;;0CAEV,8OAAC;;kDACC,8OAAC;wCAAG,WAAU;kDAAiB,EAAE,MAAM,CAAC,IAAI;;;;;;kDAC5C,8OAAC;wCAAE,WAAU;kDAAiB,EAAE,SAAS;;;;;;;;;;;;0CAG3C,8OAAC;gCAAO,WAAU;0CAAwC;;;;;;;uBARrD,EAAE,EAAE;;;;;;;;;;;;;;;;AAgBrB"}}]
}