{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/app/p/%5Bslug%5D/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useSearchParams } from \"next/navigation\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\nexport default function PropertyPage() {\r\n  const { slug } = useParams();\r\n  const search = useSearchParams();\r\n  const searchParams = useSearchParams();\r\n\r\n  const checkIn = search.get(\"check_in\");\r\n  const checkOut = search.get(\"check_out\");\r\n  const leadId = search.get(\"lead\");\r\n\r\n  const [property, setProperty] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n  if (!leadId) return;\r\n\r\n  const markViewed = async () => {\r\n    // Fetch current status\r\n    const { data: lead } = await supabase\r\n      .from(\"leads\")\r\n      .select(\"status\")\r\n      .eq(\"id\", leadId)\r\n      .single();\r\n\r\n    // Only update if still enquired\r\n    if (lead?.status === \"enquired\") {\r\n      await supabase\r\n        .from(\"leads\")\r\n        .update({ status: \"viewed\" })\r\n        .eq(\"id\", leadId);\r\n    }\r\n  };\r\n\r\n  markViewed();\r\n}, [leadId]);\r\n\r\n\r\n  const fetchProperty = async () => {\r\n    const { data } = await supabase\r\n      .from(\"properties\")\r\n      .select(\"*, areas(name)\")\r\n      .eq(\"slug\", slug)\r\n      .single();\r\n\r\n    setProperty(data);\r\n  };\r\n\r\n  const markViewed = async () => {\r\n    if (!leadId) return;\r\n\r\n    await supabase\r\n      .from(\"leads\")\r\n      .update({ status: \"viewed\" })\r\n      .eq(\"id\", leadId);\r\n  };\r\n\r\n  const markShortlisted = async () => {\r\n    if (!leadId) return;\r\n\r\n    await supabase\r\n      .from(\"leads\")\r\n      .update({ status: \"shortlisted\" })\r\n      .eq(\"id\", leadId);\r\n  };\r\n\r\n  if (!property) return <p className=\"p-10\">Loading property...</p>;\r\n\r\n  return (\r\n    <main className=\"p-6 max-w-3xl space-y-4\">\r\n      <h1 className=\"text-2xl font-bold\">{property.name}</h1>\r\n\r\n      <div className=\"text-gray-600\">\r\n        Area: {property.areas?.name}\r\n      </div>\r\n\r\n      <div className=\"text-lg font-semibold\">\r\n        Starting ₹{property.starting_price} / night\r\n      </div>\r\n\r\n      <div className=\"border p-4 rounded space-y-2\">\r\n        <div>\r\n          <b>Check-in:</b> {checkIn || \"—\"}\r\n        </div>\r\n        <div>\r\n          <b>Check-out:</b> {checkOut || \"—\"}\r\n        </div>\r\n      </div>\r\n\r\n      {/* BOOK NOW */}\r\n      <button\r\n        onClick={markShortlisted}\r\n        className=\"bg-black text-white px-4 py-2 rounded w-full\"\r\n      >\r\n        Book Now\r\n      </button>\r\n\r\n      {/* WHATSAPP */}\r\n      <button\r\n        onClick={() => {\r\n          markShortlisted();\r\n          window.open(\r\n            `https://wa.me/91${property.phone || \"\"}`,\r\n            \"_blank\"\r\n          );\r\n        }}\r\n        className=\"border px-4 py-2 rounded w-full\"\r\n      >\r\n        Chat with Owner\r\n      </button>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAHA;;;;;AAKe,SAAS;IACtB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,+IAAS;IAC1B,MAAM,SAAS,IAAA,qJAAe;IAC9B,MAAM,eAAe,IAAA,qJAAe;IAEpC,MAAM,UAAU,OAAO,GAAG,CAAC;IAC3B,MAAM,WAAW,OAAO,GAAG,CAAC;IAC5B,MAAM,SAAS,OAAO,GAAG,CAAC;IAE1B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAM;IAE9C,IAAA,kNAAS,EAAC;QACV,IAAI,CAAC,QAAQ;QAEb,MAAM,aAAa;YACjB,uBAAuB;YACvB,MAAM,EAAE,MAAM,IAAI,EAAE,GAAG,MAAM,2HAAQ,CAClC,IAAI,CAAC,SACL,MAAM,CAAC,UACP,EAAE,CAAC,MAAM,QACT,MAAM;YAET,gCAAgC;YAChC,IAAI,MAAM,WAAW,YAAY;gBAC/B,MAAM,2HAAQ,CACX,IAAI,CAAC,SACL,MAAM,CAAC;oBAAE,QAAQ;gBAAS,GAC1B,EAAE,CAAC,MAAM;YACd;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAGT,MAAM,gBAAgB;QACpB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,2HAAQ,CAC5B,IAAI,CAAC,cACL,MAAM,CAAC,kBACP,EAAE,CAAC,QAAQ,MACX,MAAM;QAET,YAAY;IACd;IAEA,MAAM,aAAa;QACjB,IAAI,CAAC,QAAQ;QAEb,MAAM,2HAAQ,CACX,IAAI,CAAC,SACL,MAAM,CAAC;YAAE,QAAQ;QAAS,GAC1B,EAAE,CAAC,MAAM;IACd;IAEA,MAAM,kBAAkB;QACtB,IAAI,CAAC,QAAQ;QAEb,MAAM,2HAAQ,CACX,IAAI,CAAC,SACL,MAAM,CAAC;YAAE,QAAQ;QAAc,GAC/B,EAAE,CAAC,MAAM;IACd;IAEA,IAAI,CAAC,UAAU,qBAAO,8OAAC;QAAE,WAAU;kBAAO;;;;;;IAE1C,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAG,WAAU;0BAAsB,SAAS,IAAI;;;;;;0BAEjD,8OAAC;gBAAI,WAAU;;oBAAgB;oBACtB,SAAS,KAAK,EAAE;;;;;;;0BAGzB,8OAAC;gBAAI,WAAU;;oBAAwB;oBAC1B,SAAS,cAAc;oBAAC;;;;;;;0BAGrC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;0CAAE;;;;;;4BAAa;4BAAE,WAAW;;;;;;;kCAE/B,8OAAC;;0CACC,8OAAC;0CAAE;;;;;;4BAAc;4BAAE,YAAY;;;;;;;;;;;;;0BAKnC,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;0BAKD,8OAAC;gBACC,SAAS;oBACP;oBACA,OAAO,IAAI,CACT,CAAC,gBAAgB,EAAE,SAAS,KAAK,IAAI,IAAI,EACzC;gBAEJ;gBACA,WAAU;0BACX;;;;;;;;;;;;AAKP"}}]
}