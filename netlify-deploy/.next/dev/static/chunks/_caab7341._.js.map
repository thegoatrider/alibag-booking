{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,iMAAY"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/goatr/alibag-booking/lib/availability.ts"],"sourcesContent":["import { supabase } from \"./supabase\";\r\n\r\nexport async function getAvailableRooms(\r\n  bucketId: string,\r\n  checkIn: string,\r\n  checkOut: string\r\n) {\r\n  // 1. Get all rooms in bucket\r\n  const { data: rooms } = await supabase\r\n    .from(\"rooms\")\r\n    .select(\"id, room_name, hotel_id, hotels(name)\")\r\n    .eq(\"hotels.bucket_id\", bucketId);\r\n\r\n  if (!rooms || rooms.length === 0) return [];\r\n\r\n  const roomIds = rooms.map((r) => r.id);\r\n\r\n  // 2. Get overlapping bookings\r\n  const { data: bookings } = await supabase\r\n    .from(\"bookings\")\r\n    .select(\"room_id\")\r\n    .lt(\"check_in\", checkOut)\r\n    .gt(\"check_out\", checkIn);\r\n\r\n  const bookedRoomIds = bookings?.map((b) => b.room_id) || [];\r\n\r\n  // 3. Get blocked dates\r\n  const { data: blocked } = await supabase\r\n    .from(\"blocked_dates\")\r\n    .select(\"room_id\")\r\n    .gte(\"date\", checkIn)\r\n    .lt(\"date\", checkOut);\r\n\r\n  const blockedRoomIds = blocked?.map((b) => b.room_id) || [];\r\n\r\n  // 4. Filter rooms\r\n  return rooms.filter(\r\n    (r) =>\r\n      !bookedRoomIds.includes(r.id) &&\r\n      !blockedRoomIds.includes(r.id)\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,kBACpB,QAAgB,EAChB,OAAe,EACf,QAAgB;IAEhB,6BAA6B;IAC7B,MAAM,EAAE,MAAM,KAAK,EAAE,GAAG,MAAM,8HAAQ,CACnC,IAAI,CAAC,SACL,MAAM,CAAC,yCACP,EAAE,CAAC,oBAAoB;IAE1B,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG,OAAO,EAAE;IAE3C,MAAM,UAAU,MAAM,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;IAErC,8BAA8B;IAC9B,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,8HAAQ,CACtC,IAAI,CAAC,YACL,MAAM,CAAC,WACP,EAAE,CAAC,YAAY,UACf,EAAE,CAAC,aAAa;IAEnB,MAAM,gBAAgB,UAAU,IAAI,CAAC,IAAM,EAAE,OAAO,KAAK,EAAE;IAE3D,uBAAuB;IACvB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,8HAAQ,CACrC,IAAI,CAAC,iBACL,MAAM,CAAC,WACP,GAAG,CAAC,QAAQ,SACZ,EAAE,CAAC,QAAQ;IAEd,MAAM,iBAAiB,SAAS,IAAI,CAAC,IAAM,EAAE,OAAO,KAAK,EAAE;IAE3D,kBAAkB;IAClB,OAAO,MAAM,MAAM,CACjB,CAAC,IACC,CAAC,cAAc,QAAQ,CAAC,EAAE,EAAE,KAC5B,CAAC,eAAe,QAAQ,CAAC,EAAE,EAAE;AAEnC"}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["C:/Users/goatr/alibag-booking/app/bucket/[bucketId]/rooms/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useSearchParams } from \"next/navigation\";\r\nimport { getAvailableRooms } from \"@/lib/availability\";\r\n\r\nexport default function RoomsPage() {\r\n  const { bucketId } = useParams();\r\n  const searchParams = useSearchParams();\r\n  const checkIn = searchParams.get(\"in\")!;\r\n  const checkOut = searchParams.get(\"out\")!;\r\n\r\n  const [rooms, setRooms] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const load = async () => {\r\n      const available = await getAvailableRooms(\r\n        bucketId as string,\r\n        checkIn,\r\n        checkOut\r\n      );\r\n      setRooms(available);\r\n      setLoading(false);\r\n    };\r\n    load();\r\n  }, [bucketId, checkIn, checkOut]);\r\n\r\n  if (loading) return <p className=\"p-10\">Checking availability...</p>;\r\n\r\n  return (\r\n    <main className=\"p-10\">\r\n      <h1 className=\"text-2xl font-bold mb-6\">\r\n        Available Rooms\r\n      </h1>\r\n\r\n      {rooms.length === 0 && (\r\n        <p className=\"text-gray-500\">\r\n          No rooms available for selected dates.\r\n        </p>\r\n      )}\r\n\r\n      <div className=\"space-y-4\">\r\n        {rooms.map((r) => (\r\n          <div\r\n            key={r.id}\r\n            className=\"border rounded-xl p-6 flex justify-between\"\r\n          >\r\n            <div>\r\n              <h2 className=\"font-semibold\">{r.hotels.name}</h2>\r\n              <p className=\"text-gray-500\">{r.room_name}</p>\r\n            </div>\r\n\r\n            <button className=\"bg-black text-white px-4 py-2 rounded\">\r\n              Select\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"],"names":["c","_c","useEffect","useState","useParams","useSearchParams","getAvailableRooms","RoomsPage","$","$i","Symbol","for","bucketId","searchParams","t0","get","checkIn","t1","checkOut","t2","rooms","setRooms","loading","setLoading","t3","t4","RoomsPage[useEffect()]","load","RoomsPage[useEffect() > load]","available","t5","t6","length","t7","map","_RoomsPageRoomsMap","t8","t9","r","id","hotels","name","room_name"],"mappings":"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","ignoreList":[]}}]
}